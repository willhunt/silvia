(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{372:function(s,a,t){"use strict";t.r(a);var e=t(42),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"pi-setup"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pi-setup"}},[s._v("#")]),s._v(" Pi Setup")]),s._v(" "),t("p",[s._v("Follow these steps to set up a raspberry pi, download the code and setup the web server and message broker.")]),s._v(" "),t("h2",{attrs:{id:"quick-setup"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#quick-setup"}},[s._v("#")]),s._v(" Quick Setup")]),s._v(" "),t("p",[s._v("A quick setup can be done using a script. First setup wireless in raspi-config:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" raspi-config\n")])])]),t("p",[s._v("Then download the script and run.")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" -y\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/willhunt/silvia.git\n$ "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /silvia/pi_setup\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x raspi_setup.sh\n$ ./raspi_setup.sh\n")])])]),t("p",[s._v("Then setup Django database")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~/silvia/silvia\n$ python manage.py migrate\n$ python manage.py createsuperuser\n")])])]),t("p",[s._v("Then follow prompts.")]),s._v(" "),t("h2",{attrs:{id:"useful-links"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#useful-links"}},[s._v("#")]),s._v(" Useful Links")]),s._v(" "),t("p",[s._v("Some useful links for the following instructions are:")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://www.codingforentrepreneurs.com/blog/raspberry-pi-network-server-guide-with-django-ssh/",target:"_blank",rel:"noopener noreferrer"}},[s._v("raspberry-pi-network-server-guide-with-django-ssh"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://mikesmithers.wordpress.com/2017/02/21/configuring-django-with-apache-on-a-raspberry-pi/",target:"_blank",rel:"noopener noreferrer"}},[s._v("configuring-django-with-apache-on-a-raspberry-pi"),t("OutboundLink")],1)])]),s._v(" "),t("h2",{attrs:{id:"pi-setup-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pi-setup-2"}},[s._v("#")]),s._v(" Pi Setup")]),s._v(" "),t("h3",{attrs:{id:"install-operating-system"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install-operating-system"}},[s._v("#")]),s._v(" Install operating system")]),s._v(" "),t("p",[s._v("Setup a raspberry pi with Raspberry Pi OS Lite as described at "),t("a",{attrs:{href:"https://projects.raspberrypi.org/en/projects/raspberry-pi-setting-up",target:"_blank",rel:"noopener noreferrer"}},[s._v("projects.raspberrypi.org"),t("OutboundLink")],1),s._v(".")]),s._v(" "),t("h3",{attrs:{id:"update-pi"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#update-pi"}},[s._v("#")]),s._v(" Update pi")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update -y\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" upgrade -y\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" autoremove\n")])])]),t("h2",{attrs:{id:"setup-ssh"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#setup-ssh"}},[s._v("#")]),s._v(" Setup SSH")]),s._v(" "),t("h3",{attrs:{id:"enable-ssh"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#enable-ssh"}},[s._v("#")]),s._v(" Enable SSH")]),s._v(" "),t("p",[s._v("Allow SSH connections on the raspberry pi by using the raspi-config tool on the raspberry pi:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" raspi-config\n")])])]),t("p",[s._v("The IP address can be found on the pi using")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hostname")]),s._v(" -I\n")])])]),t("h3",{attrs:{id:"setup-static-ip-address"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#setup-static-ip-address"}},[s._v("#")]),s._v(" Setup static IP address")]),s._v(" "),t("p",[s._v("Reference: "),t("a",{attrs:{href:"https://pimylifeup.com/raspberry-pi-static-ip-address/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Raspberry Pi Static IP Address"),t("OutboundLink")],1),s._v(". Here the IP address "),t("code",[s._v("192.168.0.6")]),s._v(" is used.")]),s._v(" "),t("p",[s._v("Edit file:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("nano")]),s._v(" /etc/dhcpcd.conf\n")])])]),t("p",[s._v("And add:")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("interface wlan0\nstatic ip_address=192.168.0.6/24\nstatic routers=192.168.0.1\nstatic domain_name_servers=192.168.0.1\n")])])]),t("p",[s._v("Replacing with relevant IP addresses. Use this to find router/name server:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip")]),s._v(" r "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" default\n")])])]),t("p",[s._v("Reboot")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("reboot")]),s._v("\n")])])]),t("h2",{attrs:{id:"connect-via-ssh"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#connect-via-ssh"}},[s._v("#")]),s._v(" Connect via SSH")]),s._v(" "),t("p",[s._v("Once enabled access can be made via another networked computer:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" pi@"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("IP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),t("p",[s._v("In my case:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" pi@192.168.0.6\n")])])]),t("h2",{attrs:{id:"allow-remote-access-to-files"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#allow-remote-access-to-files"}},[s._v("#")]),s._v(" Allow remote access to files")]),s._v(" "),t("p",[s._v("It is possible to mount file system on a local machine to make editing files easier. This can be done on the other PC by the following:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" sshfs\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" ~/remote_code\n$ sshfs pi@192.168.0.6:/home ~/remote_code\n")])])]),t("p",[s._v("Add debug option to help if there are any problems")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ sshfs pi@192.168.0.6:/home ~/remote_code -o debug\n")])])]),t("h2",{attrs:{id:"install-requirements"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install-requirements"}},[s._v("#")]),s._v(" Install requirements")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" python3-venv libopenjp2-7 libtiff5 apache2 apache2-dev libapache2-mod-wsgi-py3 redis-server i2c-tools postgresql libpq-dev postgresql-client postgresql-client-common python-dev -y\n")])])]),t("h2",{attrs:{id:"download-files"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#download-files"}},[s._v("#")]),s._v(" Download files")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/willhunt/silvia.git\n")])])]),t("h2",{attrs:{id:"setup-python-environment"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#setup-python-environment"}},[s._v("#")]),s._v(" Setup Python environment")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ python3 -m venv .virtualenvs/venv-silvia\n$ "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" .virtualenvs/venv-silvia/bin/activate\n$ "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" silvia/silvia\n$ pip "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -r requirements.txt\n")])])]),t("p",[s._v("Source virtual env by default by adding line to .bashrc")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("nano")]),s._v(" .bashrc\n")])])]),t("p",[s._v("Add at end:")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("source ~/.virtualenvs/venv-silvia/bin/activate\n")])])]),t("h2",{attrs:{id:"setup-apache-server"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#setup-apache-server"}},[s._v("#")]),s._v(" Setup Apache server")]),s._v(" "),t("h3",{attrs:{id:"edit-server-configuration"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#edit-server-configuration"}},[s._v("#")]),s._v(" Edit server configuration")]),s._v(" "),t("p",[s._v("Replace contents of "),t("code",[s._v("/etc/apache2/sites-available/000-default.conf")]),s._v(" with:")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('<VirtualHost *:80>\n    # The ServerName directive sets the request scheme, hostname and port that\n    # the server uses to identify itself. This is used when creating\n    # redirection URLs. In the context of virtual hosts, the ServerName\n    # specifies what hostname must appear in the request\'s Host: header to\n    # match this virtual host. For the default virtual host (this file) this\n    # value is not decisive as it is used as a last resort host regardless.\n    # However, you must set it for any further virtual host explicitly.\n    #ServerName www.example.com\n\n    ServerAdmin webmaster@localhost\n    DocumentRoot /var/www/html\n\n    # Available loglevels: trace8, ..., trace1, debug, info, notice, warn,\n    # error, crit, alert, emerg.\n    # It is also possible to configure the loglevel for particular\n    # modules, e.g.\n    #LogLevel info ssl:warn\n\n    ErrorLog ${APACHE_LOG_DIR}/error.log\n    CustomLog ${APACHE_LOG_DIR}/access.log combined\n\n    # For most configuration files from conf-available/, which are\n    # enabled or disabled at a global level, it is possible to\n    # include a line for only one particular virtual host. For example the\n    # following line enables the CGI configuration for this host only\n    # after it has been globally disabled with "a2disconf".\n    #Include conf-available/serve-cgi-bin.conf\n\n    Alias /static /home/pi/silvia/silvia/staticfiles\n        <Directory /home/pi/silvia/silvia/staticfiles>\n            Require all granted\n        </Directory>\n\n    WSGIDaemonProcess silvia python-path=/home/pi/silvia/silvia python-home=/home/pi/.virtualenvs/venv-silvia\n    WSGIProcessGroup silvia\n    WSGIScriptAlias / /home/pi/silvia/silvia/silvia/wsgi.py\n\n    <Directory /home/pi/silvia/silvia>\n        <Files wsgi.py>\n                Require all granted\n        </Files>\n    </Directory>\n</VirtualHost>\n')])])]),t("h3",{attrs:{id:"change-file-permissions"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#change-file-permissions"}},[s._v("#")]),s._v(" Change file permissions")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Change permissions")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" g+w ~/silvia/silvia/db.sqlite3 \n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" g+w ~/silvia/silvia\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Change owner")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" www-data:www-data ~/silvia/silvia/db.sqlite3\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" www-data:www-data ~/silvia/silvia\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" www-data:www-data ~/.virtualenvs/venv-silvia\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Change group")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupadd")]),s._v(" server_group\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" adduser pi server_group\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" adduser www-data server_group\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" adduser www-data dialout\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chgrp")]),s._v(" server_group ~/silvia/silvia/db.sqlite3\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chgrp")]),s._v(" server_group ~/silvia/silvia/\n")])])]),t("p",[s._v('*Maybe try adding "-r" argument (recursive) for chown if having problems"')]),s._v(" "),t("h2",{attrs:{id:"setup-i2c"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#setup-i2c"}},[s._v("#")]),s._v(" Setup I2C")]),s._v(" "),t("p",[s._v("Edit this file for I2C permissions:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("nano")]),s._v(" /etc/udev/rules.d/99-com.rules\n")])])]),t("p",[s._v("Change this line")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('SUBSYSTEM=="ic2-dev", GROUP="i2c", MODE="0660"\n')])])]),t("p",[s._v("to this:")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('SUBSYSTEM=="ic2-dev", GROUP="i2c", MODE="0666"\n')])])]),t("p",[s._v("Then add users to i2c group")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" adduser pi i2c\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" adduser www-data i2c\n")])])]),t("h2",{attrs:{id:"setup-postgresql-database"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#setup-postgresql-database"}},[s._v("#")]),s._v(" Setup PostgreSQL Database")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~/silvia/silvia\n$ python manage.py dumpdata --exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("contenttypes --exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("auth.Permission "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" datadump.json\n")])])]),t("p",[s._v("Edit databse configuration:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("su")]),s._v(" - postgres\n$ psql\n$ CREATE DATABASE silviadatabase"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n$ CREATE "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" databaseadmin WITH PASSWORD "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'databasepwd'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n$ ALTER ROLE databaseadmin SET client_encoding TO "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'utf8'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n$ ALTER ROLE databaseadmin SET default_transaction_isolation TO "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'read committed'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n$ ALTER ROLE databaseadmin SET timezone TO "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'GB'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n$ GRANT ALL PRIVILEGES ON DATABASE silviadatabase TO databaseadmin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("q\n$ "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n")])])]),t("p",[s._v("Migrate and recreate superuser")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ python manage.py migrate\n$ python manage.py createsuperuser\n")])])]),t("h2",{attrs:{id:"supervisor-setup"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#supervisor-setup"}},[s._v("#")]),s._v(" Supervisor Setup")]),s._v(" "),t("p",[s._v("Make logging directories")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /var/log/celery\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /var/run/celery\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /var/log/silvia\n")])])]),t("p",[s._v("Permissions")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chgrp")]),s._v(" -R server_group /var/run/celery\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chgrp")]),s._v(" -R server_group /var/log/celery\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chgrp")]),s._v(" -R server_group /var/log/silvia\n")])])]),t("p",[s._v("Configure")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -f supervisor/silvia_celery.conf /etc/supervisor/conf.d/silvia_celery.conf\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -f supervisor/silvia_celerybeat.conf /etc/supervisor/conf.d/silvia_celerybeat.conf\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -f supervisor/silvia_interrupt.conf /etc/supervisor/conf.d/silvia_interrupt.conf\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chgrp")]),s._v(" -R server_group /var/log/supervisor\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" g+wr /var/log/supervisor/supervisord.log\n")])])]),t("h2",{attrs:{id:"arduino-flashing"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#arduino-flashing"}},[s._v("#")]),s._v(" Arduino Flashing")]),s._v(" "),t("p",[s._v("Install arduino command line (cli) tool to flash it from the raspberry pi\nReference "),t("a",{attrs:{href:"https://siytek.com/arduino-cli-raspberry-pi/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://siytek.com/arduino-cli-raspberry-pi/"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("Install")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -fsSL https://raw.githubusercontent.com/arduino/arduino-cli/master/install.sh "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v("\n")])])]),t("p",[s._v("Add to shell path")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("nano")]),s._v(" ~/.bashrc\n")])])]),t("p",[s._v("Add this at the end:")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("export PATH=$PATH:/home/pi/bin\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("reboot")]),s._v("\n")])])]),t("p",[s._v("Reconnect, then create a configuration file, update board index and libraries:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ arduino-cli config init\n$ arduino-cli core update-index\n$ arduino-cli core "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" arduino:avr\n$ arduino-cli lib "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" PID "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Adafruit SSD1306"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Adafruit GFX"')]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~/Arduino/libraries\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/br3ttb/Arduino-PID-AutoTune-Library.git\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" Arduino-PID-AutoTune-Library/PID_AutoTune_v0 "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -r Arduino-PID-AutoTune-Library/\n")])])]),t("p",[s._v("Upload sketch to Arduino:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~/silvia\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x update_arduino.sh \n$ ./update_arduino.sh\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);