(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{358:function(t,a,e){"use strict";e.r(a);var r=e(42),s=Object(r.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"brew-control"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#brew-control"}},[t._v("#")]),t._v(" Brew Control")]),t._v(" "),e("p",[t._v("To actuate the brew control relays are required for both the pump and the solenoid valve. This could be done with either 2 relays or a dual relay and could be either mechanical or solid state (SSR). To save space a Crydom dual SSR was used, found on eBay for £23 delivered (although if buying new at £70+ it would be quite expensive).")]),t._v(" "),e("h2",{attrs:{id:"components"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#components"}},[t._v("#")]),t._v(" Components")]),t._v(" "),e("ul",[e("li",[t._v("Crydom D2425D Dual Solid State Relay ["),e("a",{attrs:{href:"http://www.crydom.com/en/products/catalog/dual-series-ac-panel-mount.pdf",target:"_blank",rel:"noopener noreferrer"}},[t._v("datasheet"),e("OutboundLink")],1),t._v("]\n"),e("ul",[e("li",[t._v("Control voltage range 4-15 VDC (better to use Arduino than Raspberry Pi)")]),t._v(" "),e("li",[t._v("Output voltage range 24-280 VAC")]),t._v(" "),e("li",[t._v("Output maximum load 25 A (Plenty)")])])])]),t._v(" "),e("h2",{attrs:{id:"installation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#installation"}},[t._v("#")]),t._v(" Installation")]),t._v(" "),e("p",[t._v("The relay is installed adjacent to the manual brew control to avoid any additional wiring changes. It is fixed by M3 machine screws to the body, requiring 2 3.5mm holes to be drilled.")]),t._v(" "),e("DocsImageLayout",{attrs:{images:t.$frontmatter.images_installation,srcBase:"/silvia/assets/build/"}}),t._v(" "),e("h2",{attrs:{id:"wiring"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#wiring"}},[t._v("#")]),t._v(" Wiring")]),t._v(" "),e("p",[t._v("The Arduino controls the relay which requires >4V input (raspberry pi is 3.3V). A 10kΩ pull-down resistor is used to ensure the relay input is at 0V when the output in not high. The raspberry pi detects the switch operation via a GPIO pin. This does not require a pull up/down resistor as they are built in.")]),t._v(" "),e("DocsImageLayout",{attrs:{images:t.$frontmatter.images_wiring,size:"lg",srcBase:"/silvia/assets/build/"}}),t._v(" "),e("h2",{attrs:{id:"software"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#software"}},[t._v("#")]),t._v(" Software")]),t._v(" "),e("h3",{attrs:{id:"raspberry-pi-interrupt"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#raspberry-pi-interrupt"}},[t._v("#")]),t._v(" Raspberry pi interrupt")]),t._v(" "),e("p",[t._v("The raspberry pi gpiozero "),e("a",{attrs:{href:"https://gpiozero.readthedocs.io/en/stable/api_input.html#gpiozero.Button",target:"_blank",rel:"noopener noreferrer"}},[t._v("Button class"),e("OutboundLink")],1),t._v(" is used to detect switch operation which then communicates to the Arduino over I2C via "),e("a",{attrs:{href:"https://github.com/celery/celery",target:"_blank",rel:"noopener noreferrer"}},[t._v("Celery"),e("OutboundLink")],1),t._v(" asyncrhonus tasks.")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" gpiozero "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Button\n\nbutton_brew "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Button"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("27")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nbutton_brew"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("when_pressed "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" trigger_brew_start\nbutton_brew"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("when_released "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" trigger_brew_stop\n")])])]),e("p",[t._v("The python interrupt file is registered as a django management command:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ python manage.py raspi_interrupt\n")])])]),e("h3",{attrs:{id:"arduino-relay-control"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#arduino-relay-control"}},[t._v("#")]),t._v(" Arduino relay control")]),t._v(" "),e("p",[t._v("A generic relay control class was used to operate the relays through the standard Arduino interface with the relevant "),e("code",[t._v("on()")]),t._v(" method being:")]),t._v(" "),e("div",{staticClass:"language-cpp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-cpp"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" RelayOutput"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  status_ "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("digitalWrite")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pin_"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" HIGH"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])])],1)}),[],!1,null,null,null);a.default=s.exports}}]);